(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[786],{46:e=>{e.exports={"make-an-appointment":"BookingForm_make-an-appointment__6PppQ",inputs:"BookingForm_inputs__N28dA","input-group":"BookingForm_input-group__YYSjc","checkbox-group":"BookingForm_checkbox-group__nt71T",label:"BookingForm_label__g8wxP",input:"BookingForm_input__Hoeo2","checkbox-appoint":"BookingForm_checkbox-appoint__BQHGB","checkbox-check":"BookingForm_checkbox-check__ZWMxd","checkbox-label":"BookingForm_checkbox-label__zlAwj","input-group1":"BookingForm_input-group1__G_q0R","sign-up-button":"BookingForm_sign-up-button__7n0Ka"}},142:(e,t,c)=>{"use strict";c.d(t,{ModalProvider:()=>r,h:()=>n});var a=c(5155),l=c(2115);let o=(0,l.createContext)();function n(){return(0,l.useContext)(o)}function r(e){let{children:t}=e,[c,n]=(0,l.useState)(null);return(0,a.jsx)(o.Provider,{value:{modal:c,openModal:e=>n(e),closeModal:()=>n(null)},children:t})}},5063:e=>{e.exports={wrapper:"Calendar_wrapper__8_SJc",calendar:"Calendar_calendar__diHS_"}},5508:e=>{e.exports={wrapper:"TimeSelect_wrapper__aUwuW",input:"TimeSelect_input__yg85Y",placeholder:"TimeSelect_placeholder__xlTgA",opacity:"TimeSelect_opacity__mrZ0z","accordion-icon":"TimeSelect_accordion-icon__yakks",popover:"TimeSelect_popover__Y5fNX",option:"TimeSelect_option__f_wz6",disabled:"TimeSelect_disabled__OFmhm"}},6037:e=>{e.exports={wrapper:"Select_wrapper__pnFSg",input:"Select_input__Kq1hV",placeholder:"Select_placeholder__awo_b",opacity:"Select_opacity__xxvS6","accordion-icon":"Select_accordion-icon__lzFBu",popover:"Select_popover_____gO",option:"Select_option__HM7kA",disabled:"Select_disabled__ICFCK"}},6786:(e,t,c)=>{"use strict";c.d(t,{BookingForm:()=>k});var a=c(5155),l=c(2115),o=c(2211);c(9303);var n=c(5063),r=c.n(n);let s=e=>{let{onSelect:t,selected:c}=e,[n,s]=(0,l.useState)();(0,l.useEffect)(()=>{void 0!==c&&s(c)},[c]);let i=void 0!==c?c:n;return(0,a.jsx)("div",{className:r().wrapper,children:(0,a.jsx)(o.h,{className:r().calendar,animate:!0,mode:"single",selected:i,onSelect:e=>{t&&t(e),void 0===c&&s(e)},navLayout:"around"})})};var i=c(5508),d=c.n(i);function u(e){let{blocked:t=[],start:c="09:00",end:o="18:00",interval:n=30,onSelect:r,selected:s,placeholder:i="Выберите время"}=e,[u,p]=(0,l.useState)(!1),[m,h]=(0,l.useState)(""),_=(0,l.useRef)(null),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"09:00",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"18:00",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,a=[],[l,o]=e.split(":").map(Number),[n,r]=t.split(":").map(Number),s=new Date;s.setHours(l,o,0,0);let i=new Date;for(i.setHours(n,r,0,0);s<=i;){let e=String(s.getHours()).padStart(2,"0"),t=String(s.getMinutes()).padStart(2,"0");a.push("".concat(e,":").concat(t)),s.setMinutes(s.getMinutes()+c)}return a}(c,o,n);(0,l.useEffect)(()=>{let e=e=>{_.current&&!_.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,l.useEffect)(()=>{void 0!==s&&h(s)},[s]);let v=e=>{t.includes(e)||(p(!1),r&&r(e),void 0===s&&h(e))},x=void 0!==s?s:m;return(0,a.jsxs)("div",{className:d().wrapper,ref:_,children:[(0,a.jsxs)("button",{onClick:()=>p(!u),className:d().input,type:"button",children:[(0,a.jsx)("p",{className:"".concat(d().placeholder," ").concat(x?"":d().opacity),children:x||i}),(0,a.jsx)("img",{className:d()["accordion-icon"],src:"/images/icons/accordSignUp.svg",alt:"icon"})]}),u&&(0,a.jsx)("div",{className:d().popover,children:g.map(e=>{let c=t.includes(e);return(0,a.jsx)("div",{className:"".concat(d().option," ").concat(c?d().disabled:""," ").concat(x===e?d().selected:""),onClick:()=>v(e),children:e},e)})})]})}var p=c(6037),m=c.n(p);function h(e){let{options:t=[],onSelect:c,selected:o,blocked:n=[],placeholder:r="Выберите вариант"}=e,[s,i]=(0,l.useState)(!1),[d,u]=(0,l.useState)(""),p=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let h=e=>(null==e?void 0:e.name)||(null==e?void 0:e.text)||(null==e?void 0:e.title)||"",_=e=>{let t=h(e);n.includes(t)||(i(!1),c&&c(e),void 0===o&&u(e))},g=void 0!==o?o:d;return(0,a.jsxs)("div",{className:m().wrapper,ref:p,children:[(0,a.jsxs)("button",{onClick:()=>i(!s),className:m().input,type:"button",children:[(0,a.jsx)("p",{className:"".concat(m().placeholder," ").concat(g?"":m().opacity),children:g?h(g):r}),(0,a.jsx)("img",{className:m()["accordion-icon"],src:"/images/icons/accordSignUp.svg",alt:"icon"})]}),s&&(0,a.jsxs)("div",{className:m().popover,children:[0===t.length&&(0,a.jsx)("div",{className:m().empty,children:"Нет доступных вариантов"}),t.map((e,t)=>{let c=h(e),l=n.includes(c);return(0,a.jsx)("div",{className:"".concat(m().option," ").concat(l?m().disabled:""," ").concat(h(g)===c?m().selected:""),onClick:()=>_(e),children:c},e.id||t)})]})]})}var _=c(46),g=c.n(_),v=c(9972),x=c(8543);c(5716);var b=c(142);let j=e=>{let{name:t,tel:c,date:a,time:l,doctor:o,service:n,doctors:r,services:s,personalData:i}=e,d={};t&&t.trim()||(d.name="ФИО обязательно");let u=c.replace(/\D/g,"");u.startsWith("8")&&11===u.length&&(u="7"+u.slice(1)),/^7\d{10}$/.test(u)||(d.tel="Телефон должен быть в формате +7XXXXXXXXXX или 8XXXXXXXXXX");let p="+7"+u.slice(-10);return a||(d.date="Дата обязательна"),l||(d.time="Время обязательно"),r.length>0&&!o&&(d.doctor="Выберите специалиста"),s.length>0&&!n&&(d.service="Выберите услугу"),i||(d.personalData="Необходимо согласие на обработку данных"),{errors:d,formattedPhone:p}};function k(e){let{services:t=[],doctors:c=[]}=e,{closeModal:o}=(0,b.h)(),[n,r]=(0,l.useState)(null),[i,d]=(0,l.useState)(""),[p,m]=(0,l.useState)(null),[_,k]=(0,l.useState)(null),[S,N]=(0,l.useState)(""),[f,y]=(0,l.useState)(""),[w,F]=(0,l.useState)(!1),[X,C]=(0,l.useState)(!1),[B,T]=(0,l.useState)(!1),[D,E]=(0,l.useState)({}),M=async e=>{e.preventDefault(),E({}),T(!0);let{errors:a,formattedPhone:l}=j({name:S,tel:f,date:n,time:i,doctor:p,service:_,doctors:c,services:t,personalData:X});if(Object.keys(a).length>0){E(a),T(!1);return}let s={fullName:S.trim(),phone:l,date:n,time:i,doctor:(null==p?void 0:p.id)||null,service:(null==_?void 0:_.id)||(null==_?void 0:_.text)||(null==_?void 0:_.name)||null,callMe:w,personalDataConsent:X},u=await (0,v.gG)(s);if(u.error||u.message){E({global:u.message||u.error}),T(!1);return}x.oR.success("Запись успешно создана!",{position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,transition:x.br,theme:"colored"}),o(),T(!1),r(null),d(""),m(null),k(null),N(""),y(""),F(!1),C(!1)};return(0,a.jsxs)("form",{className:g()["make-an-appointment"],onSubmit:M,children:[(0,a.jsxs)("div",{className:g()["calendar-wrapper"],children:[(0,a.jsx)(s,{onSelect:r,selected:n}),D.date&&(0,a.jsx)("div",{style:{color:"red",marginTop:"0.5rem"},children:D.date})]}),(0,a.jsxs)("div",{className:g().inputs,children:[(0,a.jsxs)("div",{className:"".concat(g()["input-group"]," ").concat(g()["input-group1"]),children:[(0,a.jsxs)("label",{className:g().label,children:["Выберите время",(0,a.jsx)("div",{className:g()["select-wrapper"],children:(0,a.jsx)(u,{blocked:["10:00","11:30"],onSelect:d,selected:i})}),D.time&&(0,a.jsx)("div",{style:{color:"red"},children:D.time})]}),c.length>0&&(0,a.jsxs)("label",{className:g().label,children:["Выберите специалиста",(0,a.jsx)("div",{className:g()["select-wrapper"],children:(0,a.jsx)(h,{options:c,placeholder:"Выберите специалиста",onSelect:m,selected:p})}),D.doctor&&(0,a.jsx)("div",{style:{color:"red"},children:D.doctor})]}),t.length>0&&(0,a.jsxs)("label",{className:g().label,children:["Выберите услугу",(0,a.jsx)("div",{className:g()["select-wrapper"],children:(0,a.jsx)(h,{options:t,placeholder:"Выберите услугу",onSelect:k,selected:_})}),D.service&&(0,a.jsx)("div",{style:{color:"red"},children:D.service})]})]}),(0,a.jsxs)("div",{className:g()["input-group"],children:[(0,a.jsxs)("label",{className:g().label,htmlFor:"name",children:["Введите ваше ФИО",(0,a.jsx)("input",{className:g().input,type:"text",name:"name",id:"name",placeholder:"Иван Иванов Иванович",value:S,onChange:e=>N(e.target.value)}),D.name&&(0,a.jsx)("div",{style:{color:"red"},children:D.name})]}),(0,a.jsxs)("label",{className:g().label,htmlFor:"tel",children:["Введите номер телефона",(0,a.jsx)("input",{className:g().input,type:"tel",name:"tel",id:"tel",placeholder:"+7(999) 999-99-99",value:f,onChange:e=>y(e.target.value)}),D.tel&&(0,a.jsx)("div",{style:{color:"red"},children:D.tel})]})]}),(0,a.jsxs)("div",{className:g()["checkbox-group"],children:[(0,a.jsxs)("div",{className:g()["checkbox-appoint"],children:[(0,a.jsx)("input",{id:"checkbox-call",className:g()["checkbox-check"],type:"checkbox",name:"callback",checked:w,onChange:e=>F(e.target.checked)}),(0,a.jsx)("label",{htmlFor:"checkbox-call",className:g()["checkbox-label"],children:"Перезвонить мне"})]}),(0,a.jsxs)("div",{className:g()["checkbox-appoint"],children:[(0,a.jsx)("input",{id:"checkbox-personal-data",className:g()["checkbox-check"],type:"checkbox",name:"personalData",checked:X,onChange:e=>C(e.target.checked),required:!0}),(0,a.jsxs)("label",{htmlFor:"checkbox-personal-data",className:g()["checkbox-label"],children:["Нажимая на кнопку, я даю согласие на обработку"," ",(0,a.jsx)("a",{href:"/policy",target:"_blank",rel:"noopener noreferrer",children:"персональных данных"})]}),D.personalData&&(0,a.jsx)("div",{style:{color:"red"},children:D.personalData})]})]}),D.global&&(0,a.jsx)("div",{className:g().error,children:D.global}),(0,a.jsx)("button",{className:g()["sign-up-button"],type:"submit",disabled:B,children:B?"Отправка...":"Записаться на приём"})]})]})}},9972:(e,t,c)=>{"use strict";c.d(t,{gG:()=>x,ar:()=>b,mn:()=>j,Ru:()=>m,QF:()=>r,jp:()=>g,iD:()=>_,J9:()=>v,kz:()=>h,cO:()=>s,M$:()=>n});let a="http://localhost:5000/api",l="http://localhost:5000",o={img:{doctors:"".concat(l,"/uploads/doctors/"),services:"".concat(l,"/uploads/services/"),users:"".concat(l,"/uploads/users/")},register:"".concat(a,"/auth/register"),login:"".concat(a,"/auth/login"),me:"".concat(a,"/user/me"),appointments:"".concat(a,"/appointments"),doctors:"".concat(a,"/doctors"),services:"".concat(a,"/services")},n=e=>localStorage.setItem("jwt",e),r=()=>localStorage.getItem("jwt"),s=()=>localStorage.removeItem("jwt"),i=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],c={};return t&&(c["Content-Type"]="application/json"),e&&(c.Authorization="Bearer ".concat(e)),c},d=async e=>{let t;try{t=await e.json()}catch(e){return{error:!0,message:"Невозможно прочитать ответ от сервера"}}return e.ok?t:{error:!0,message:(null==t?void 0:t.message)||"Ошибка: ".concat(e.status)}},u=async(e,t)=>{try{let c=await fetch(e,{headers:i(t,!1),credentials:"include"}),a=await d(c);if(a.error)return a;return function e(t){return Array.isArray(t)?t.map(e):t&&"object"==typeof t?Object.fromEntries(Object.entries(t).map(t=>{let[c,a]=t;return["_id"===c?"id":c,e(a)]})):t}(a)}catch(e){return{error:!0,message:"Ошибка получения данных"}}},p=async(e,t,c)=>{try{let a=await fetch(e,{method:"POST",headers:i(c),body:JSON.stringify(t),credentials:"include"});return await d(a)}catch(e){return{error:!0,message:"Ошибка отправки данных"}}},m=e=>"".concat(o.img.doctors).concat(e),h=e=>p(o.register,e),_=e=>p(o.login,e),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r();return u(o.me,e)},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r();return patchAuthorizenData(o.me,e,t)},x=e=>p(o.appointments,e),b=()=>u(o.doctors),j=()=>u(o.services)}}]);